# 2025年7月24日

## rails-ujsについて
### 概要
https://github.com/rails/rails/blob/main/actionview/app/assets/javascripts/rails-ujs.js に書かれてる。RailsアプリケーションでJavaScriptを控えめに使用するための仕組み

### 例
#### CSRFトークンが自動的にヘッダーに付与される動き

以下のようにCSRFトークンを付与する関数が定義されてて
```javascript
const csrfParam = () => {
    const meta = document.querySelector("meta[name=csrf-param]");
    return meta && meta.content;
};

const CSRFProtection = xhr => {
    const token = csrfToken();
    if (token) {
      return xhr.setRequestHeader("X-CSRF-Token", token);
    }
};
```

ソースコードの下の方に以下のコードが書かれていて、jQuery の全 AJAX リクエストに対して、“送信前” に一律でCSRFトークンが付与されるようになっている。
```javascript
jQuery.ajaxPrefilter((function(options, originalOptions, xhr) {
    if (!options.crossDomain) {
        return CSRFProtection(xhr);
    }
}));
```

### まとめ
他にもaタグがクリックされた際の挙動だったり、様々な処理をよしなにしてくれているらしい。


<br>

## JqueryとFetch

### Jquery

<br>

## secure content

<br>

## 今日の疑問
### JqueryはPromiseではないものを返すと思ってたけど、awaitで受け取れている？
